# SailZen PRD文档

**版本**: 1.0
**日期**: 2025-11-23

## 1. 产品概述

### 1.1 产品简介

SailZen 是一款面向长篇小说创作者的、由大型语言模型 (LLM) 驱动的世界观构建与辅助创作工具。它旨在解决长篇创作中常见的两大痛点：
1.  **世界观一致性维护**：在数十万字甚至数百万字的篇幅中，保持人物、地点、事件、设定等元素的一致性极具挑战。
2.  **创作流程管理**：从灵感闪现、设定构建，到情节规划、正文撰写和后期重构，传统写作工具缺乏对这一复杂流程的结构化支持。

SailZen 通过将小说的“世界观知识库”与“叙事文本”分离又关联的核心思想，提供一个集分析、创作、管理于一体的集成环境。它以后端 RESTful API 和数据库为基础，以前端的 VSCode 插件为载体，深度融合 LLM 的能力，赋能创作者构建宏大而严谨的虚构世界。

### 1.2 目标用户

-   **长篇小说作者**：特别是创作奇幻、科幻等拥有复杂世界观的作者。
-   **剧本编剧**：需要管理复杂角色关系和多线叙事的编剧。
-   **游戏世界观架构师**：为电子游戏构建背景故事和设定的专业人士。
-   **桌面角色扮演游戏 (TRPG) 主持人 (DM/GM)**：需要创建和管理战役世界的游戏主持人。


### 1.3 核心目标

-   **目标 1：成为世界观构建的核心枢纽**。提供从零开始构建、管理和演化世界观知识的能力，使其独立于任何具体文稿。
-   **目标 2：打造无缝的 LLM 辅助创作体验**。将 LLM 的能力深度集成到写作的每一个环节，从创意启发、内容生成到一致性检查和文本重构。
-   **目标 3：实现知识与文本的动态同步**。在保持灵活性的同时，确保小说正文的内容能准确反映世界观的最新设定，反之亦然。
-   **目标 4：提供强大的重构与分析工具**。当核心设定变更时，能智能地定位所有受影响的文本和情节，极大降低修改成本。


## 2. 功能需求

SailZen 的功能体系分为两大核心模块：**世界观分析 (Analysis-First)** 和 **辅助创作 (Creation-First)**。

### 2.1 模块一：世界观分析 (Analysis-First Workflow)

此模块主要针对**已存在的文稿**，进行深度分析和知识提取。

| 功能点 | 描述 | 用户价值 |
| :--- | :--- | :--- |
| **2.1.1 手稿导入与解析** | 用户可以导入多种格式（如 .txt, .md）的完整小说手稿。系统会将其解析成一个结构化的树形文档（卷 > 章 > 节 > 段），并存储每个节点的文本和元数据。 | 将非结构化的文本转化为可供机器分析和处理的结构化数据，是所有后续分析的基础。 |
| **2.1.2 实体自动抽取** | 利用 LLM 遍历手稿，自动识别并抽取出核心实体，如人物、地点、组织、物品、概念等。 | 快速从海量文本中建立起核心世界观元素的目录，极大节省人工整理时间。 |
| **2.1.3 实体关系挖掘** | 在实体抽取的基础上，分析实体之间的关系（如家庭、敌对、从属）和关键事件，并找到文本中的证据支撑。 | 自动构建出世界观的知识图谱，帮助作者理解人物关系网和故事的因果链。 |
| **2.1.4 协同标注与审核** | 提供一个工作流，允许 LLM 自动生成的标注（实体、关系）由人工进行审核、修改或确认。所有变更都有完整的历史记录，支持追溯和回滚。 | 结合了 LLM 的效率和人类的精准判断，确保知识库的最终质量。 |
| **2.1.5 知识可视化** | 在 VSCode 插件中，以列表、详情面板等形式展示已抽取的实体。用户可以方便地查看任何一个实体的所有提及（mentions）在原文中的位置。 | 提供一个随时可查的世界观速查手册，帮助作者在写作时快速回忆起细节。 |

### 2.2 模块二：辅助创作 (Creation-First Workflow)

此模块支持用户**从一个空白项目开始**，逐步构建世界观并撰写小说。

| 功能点 | 描述 | 用户价值 |
| :--- | :--- | :--- |
| **2.2.1 独立世界观构建** | 用户可以在不撰写任何正文的情况下，创建和管理世界观中的所有知识元素（人物、设定、地点等）。提供脑图、看板等多种可视化工具进行组织。 | 允许作者在创作初期专注于顶层设计，先构建一个坚实的世界观骨架，再填充叙事血肉。 |
| **2.2.2 结构化情节规划** | 提供时间轴、大纲视图等工具，让用户可以结构化地规划故事情节。支持创建“人物弧光”、“情节线”等高级叙事结构，并将事件和人物与之关联。 | 将抽象的叙事结构具象化，帮助作者掌控故事节奏，确保角色成长路径清晰、情节逻辑连贯。 |
| **2.2.3 LLM 创意启发** | 在世界观构建和情节规划阶段，用户可以随时向 LLM 请求创意，如“为我的主角起三个符合性格的名字”、“设计一个有趣的魔法系统副作用”等。 | 克服“创意枯竭”，为作者提供源源不断的灵感，拓宽创作思路。 |
| **2.2.4 上下文感知写作** | 在撰写正文时，编辑器能够实时感知当前上下文。用户可以将文本内容与知识库中的实体链接。LLM 在提供续写或润色建议时，会自动参考相关的世界观设定和情节规划，确保生成内容的一致性。 | 实现了“心中有数，下笔有神”。作者无需频繁翻阅设定文档，LLM 也能“理解”故事背景，成为一个真正懂行的创作伙伴。 |
| **2.2.5 智能重构引擎** | 当作者修改了某个核心设定（例如，主角的动机）时，系统能自动分析并高亮出正文中所有可能与此变更相矛盾的段落。 | 这是 SailZen 的核心创新之一。它将长篇小说重构这一最痛苦、最耗时的工作，变为一个有精确导航的、半自动化的流程，极大地解放了生产力。 |
| **2.2.6 LLM 辅助重构** | 针对上一步中标记出的不一致段落，用户可以一键请求 LLM 根据新的设定进行重写。LLM 会在保持原意图的基础上，智能地调整措辞和逻辑。 | 将重构的执行成本降至最低，让作者可以无畏地进行“大手术”，大胆地迭代和优化自己的故事。 |

### 2.3 VSCode 插件 (前端交互)

| 功能点 | 描述 |
| :--- | :--- |
| **2.3.1 工作区管理** | 支持将远程作品 (`Work`) 拉取到本地，形成一个文件目录结构，实现本地优先的编辑体验和离线支持。所有本地的修改都会自动、异步地与后端同步。 |
| **2.3.2 多视图工作台** | - **章节树视图**：以树状结构管理 `Edition` 的所有章节 (`document_node`)。<br>- **世界视图**：用于独立构建和可视化世界观知识。<br>- **情节视图**：用于规划情节线和人物弧光。<br>- **实体面板**：用于快速检索和查看已创建的实体。 |
| **2.3.3 增强编辑器** | - **知识链接**：通过右键菜单、命令或拖拽，将文本与知识实体关联。<br>- **内联 LLM 建议**：以幽灵文本或 Diff 视图的形式，在不离开编辑器的情况下提供 LLM 的写作建议。<br>- **不一致性高亮**：通过编辑器诊断功能，实时提示文本与当前设定的潜在冲突。 |
| **2.3.4 冲突解决** | 提供三方对比工具，用于解决本地文件与服务器版本之间的冲突。 |

---

## 3. 非功能性需求

| 类别 | 需求 |
| :--- | :--- |
| **性能** | - 插件启动时间应小于 3 秒。<br>- 文本编辑和UI响应应无明显延迟。<br>- 对 100 万字级别的手稿进行分析和索引，查询响应（如查找实体所有提及）应在 2 秒内返回。 |
| **可靠性** | - 本地与后端的同步机制必须可靠，有重试和冲突解决机制，确保数据不丢失。<br>- 离线模式功能完善，网络恢复后能自动完成同步。 |
| **易用性** | - 遵循 VSCode 的设计规范，提供原生、流畅的用户体验。<br>- 核心工作流清晰易懂，对新用户有引导教程。 |
| **安全性** | - 用户数据在传输和存储过程中应加密。<br>- 身份认证和权限控制明确，确保用户只能访问自己的作品。 |
| **可扩展性** | - 后端架构应采用微服务或模块化设计，便于未来新增功能。<br>- LLM 服务应可插拔，方便替换或增加新的模型提供商。 |

---

## 4. 未来展望

-   **多人实时协作**：支持多位作者在同一个世界观和手稿上进行类似 Google Docs 的实时协同创作。
-   **多模态支持**：允许在世界观中管理图片（如地图、角色肖像）、音频等非文本素材。
-   **发布与导出**：提供一键导出为标准电子书格式（ePub, PDF）或发布到网络小说平台的功能。
-   **高级叙事分析**：利用 LLM 分析故事的节奏、情感曲线、角色出场频率等，为作者提供数据驱动的创作建议。
